{% block oro_product_kit_line_item_widget %}
    <div class="product-view-quantity form-row">
        <div class="product-view-quantity__unit{% if form.unit.vars.choices|length == 1 %} product-view-quantity__unit--half{% endif %}">
            {% if form.unit.vars.choices|length > 1 %}
                {{ form_row(form.unit, {label: false}) }}
            {% else %}
                <div class="product-view-quantity__unit-label" data-role="unit-label">
                    {{- value.product.primaryUnitPrecision.unit.code|oro_format_product_unit_label -}}
                </div>
                <div class="hidden">
                    <input type="hidden" name="{{ form.unit.vars.full_name }}"
                           value="{{ value.product.primaryUnitPrecision.unit.code }}"
                           data-name="{{ form.unit.vars.attr['data-name'] }}"
                           data-unit-precisions="{{ form.unit.vars.attr['data-unit-precisions'] }}"/>
                </div>
            {% endif %}
        </div>
        <div class="product-view-quantity__value{% if form.unit.vars.choices|length == 1 %} product-view-quantity__value--half{% endif %}">
            {{ form_row(form.quantity, {label: false, attr: {'aria-label': 'oro.product.quantity.aria_label'|trans }}) }}
        </div>
        <div class="fields-row-error"></div>
    </div>

    <div class="product-view-quantity form-row">
        {{ form_row(form.kitItemLineItems, {label: false}) }}
    </div>
{% endblock %}

{% block _oro_product_kit_line_item_kitItemLineItems_entry_label %}
    {{ form_label(form, value.kitItem.labels|localized_value|e, {required: not value.kitItem.optional}) }}
{% endblock %}

{% block _oro_product_kit_line_item_kitItemLineItems_entry_widget %}
    <div class="product-kit-item-line-item-title form-row">
    </div>

    <div class="product-kit-item-line-item-product form-row">
        {{ form_row(form.product, {label: false}) }}
    </div>

    <div class="product-view-quantity form-row">
        <div class="product-view-quantity__unit product-view-quantity__unit--half">
            <div class="product-view-quantity__unit-label" data-role="unit-label">
                {{- value.kitItem.productUnit.code|oro_format_product_unit_label -}}
            </div>
        </div>
        <div class="product-view-quantity__value product-view-quantity__value--half">
            {{ form_row(form.quantity, {label: false, attr: {'aria-label': 'oro.shoppinglist.productkititemlineitem.quantity.aria_label'|trans}}) }}
        </div>
        <div class="fields-row-error"></div>
    </div>
{% endblock %}

{% block _oro_product_kit_line_item_kitItemLineItems_entry_product_widget %}
    <div {{ block('widget_container_attributes') }}>
        <table class="table">
            <tbody>
            {%- for index, choice in choices -%}
                <tr>
                    <td>
                        {{- form_row(form[index], {label: false, product: choice.data}) -}}
                    </td>
                </tr>
            {%- endfor -%}
            </tbody>
        </table>
    </div>
{% endblock %}

{% block _oro_product_kit_line_item_kitItemLineItems_entry_product_entry_widget %}
    {% set label %}
        {% if product is not null %}
            {% set productImageData = product.imagesByType('listing').first.image|default(null) %}
            {% set productName = product.names|localized_value %}
            {% include '@OroAttachment/Twig/picture.html.twig' with {
                sources: product_filtered_picture_sources(productImageData, 'product_small')
            } %}
            <span>{{ product.skuUppercase ~ ' - ' ~ productName|e }}</span>
        {% else %}
            <span>{{ 'oro.frontend.shoppinglist.product_kit_line_item.dialog_widget.product_kit_item_line_item.product.choices.none'|trans }}</span>
        {% endif %}
    {% endset %}

    {{ block('radio_widget') }}
{% endblock %}
